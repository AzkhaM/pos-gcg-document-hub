<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Data Test</title>
</head>
<body>
    <h1>Checklist Data Test</h1>
    
    <div>
        <h2>Test localStorage</h2>
        <button onclick="testLocalStorage()">Test localStorage</button>
        <button onclick="clearLocalStorage()">Clear localStorage</button>
        <div id="localStorageResult"></div>
    </div>
    
    <div>
        <h2>Test Custom Events</h2>
        <button onclick="testCustomEvent()">Test Custom Event</button>
        <div id="eventResult"></div>
    </div>
    
    <div>
        <h2>Current localStorage Data</h2>
        <pre id="currentData"></pre>
    </div>

    <script>
        // Test localStorage
        function testLocalStorage() {
            const testData = [
                {
                    id: Date.now(),
                    aspek: 'Test Aspek',
                    deskripsi: 'Test Deskripsi',
                    status: 'pending',
                    catatan: 'Test Catatan',
                    tahun: 2024
                }
            ];
            
            localStorage.setItem('checklistGCG', JSON.stringify(testData));
            displayCurrentData();
            document.getElementById('localStorageResult').innerHTML = 'Data saved to localStorage: ' + JSON.stringify(testData);
        }
        
        // Clear localStorage
        function clearLocalStorage() {
            localStorage.removeItem('checklistGCG');
            displayCurrentData();
            document.getElementById('localStorageResult').innerHTML = 'localStorage cleared';
        }
        
        // Test custom event
        function testCustomEvent() {
            const testData = [
                {
                    id: Date.now(),
                    aspek: 'Event Test Aspek',
                    deskripsi: 'Event Test Deskripsi',
                    tahun: 2024
                }
            ];
            
            const event = new CustomEvent('checklistUpdated', {
                detail: { type: 'checklistUpdated', data: testData }
            });
            
            window.dispatchEvent(event);
            document.getElementById('eventResult').innerHTML = 'Custom event dispatched: ' + JSON.stringify(event.detail);
        }
        
        // Listen for custom events
        window.addEventListener('checklistUpdated', (event) => {
            console.log('Received checklistUpdated event:', event.detail);
            document.getElementById('eventResult').innerHTML = 'Event received: ' + JSON.stringify(event.detail);
        });
        
        // Display current data
        function displayCurrentData() {
            const data = localStorage.getItem('checklistGCG');
            if (data) {
                try {
                    const parsed = JSON.parse(data);
                    document.getElementById('currentData').textContent = JSON.stringify(parsed, null, 2);
                } catch (error) {
                    document.getElementById('currentData').textContent = 'Error parsing data: ' + error.message;
                }
            } else {
                document.getElementById('currentData').textContent = 'No data in localStorage';
            }
        }
        
        // Initialize display
        displayCurrentData();
        
        // Update display every second
        setInterval(displayCurrentData, 1000);
    </script>
</body>
</html>
